---
phase: 07.5-arabic-english-typography-spacing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - constants/theme.ts
  - hooks/useCachedFonts.ts
autonomous: true

must_haves:
  truths:
    - "Typography constants use 1.75x line height multiplier for Arabic text"
    - "Letter spacing is 0 for Arabic to maintain character connections"
    - "Cairo font is configured as the primary font family"
    - "Platform-specific line height adjustments are in place"
  artifacts:
    - path: "constants/theme.ts"
      provides: "Arabic-optimized typography configuration"
      contains: "LINE_HEIGHT_MULTIPLIER_ARABIC = 1.75"
    - path: "hooks/useCachedFonts.ts"
      provides: "Cairo font loading hook"
      contains: "Cairo_400Regular"
  key_links:
    - from: "constants/theme.ts"
      to: "hooks/useCachedFonts.ts"
      via: "Font family names match loaded fonts"
      pattern: "Cairo_\\d+\\w+"
---

<objective>
Update typography constants and create Cairo font loading infrastructure

Purpose: Fix Arabic text rendering by switching from Tajawal (iOS clipping issues) to Cairo font and implementing proper line heights (1.75x multiplier) for Arabic diacritics (tashkeel)

Output: Updated theme.ts with Arabic-optimized typography and useCachedFonts hook for Cairo font loading
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/07.5-arabic-english-typography-spacing/07.5-RESEARCH.md
@constants/theme.ts
@app/_layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Typography Constants with Arabic-Optimized Values</name>
  <files>constants/theme.ts</files>
  <action>
Update the Typography object in constants/theme.ts with:

1. Add line height calculation function at the top of the file (after imports):
```typescript
import { Platform } from 'react-native';

// Line height multipliers based on research
// Arabic requires 1.6-1.8x for diacritics vs 1.3-1.5x for English
const LINE_HEIGHT_MULTIPLIER_ARABIC = 1.75;
const LINE_HEIGHT_MULTIPLIER_ENGLISH = 1.4;
const ANDROID_LINE_HEIGHT_OFFSET = 2; // Android applies lineHeight only on top

const calculateLineHeight = (
  fontSize: number,
  isArabic: boolean = true
): number => {
  const multiplier = isArabic
    ? LINE_HEIGHT_MULTIPLIER_ARABIC
    : LINE_HEIGHT_MULTIPLIER_ENGLISH;

  const baseHeight = fontSize * multiplier;

  // Platform-specific adjustment for Android
  if (Platform.OS === 'android') {
    return Math.round(baseHeight + ANDROID_LINE_HEIGHT_OFFSET);
  }

  return Math.round(baseHeight);
};
```

2. Update Typography.fontFamily to use Cairo instead of Tajawal:
```typescript
fontFamily: {
  regular: 'Cairo_400Regular',
  medium: 'Cairo_500Medium',
  semibold: 'Cairo_600SemiBold',
  semiBold: 'Cairo_600SemiBold', // Alias for camelCase usage
  bold: 'Cairo_700Bold',
  extrabold: 'Cairo_800ExtraBold',
  black: 'Cairo_900Black',
},
```

3. Update lineHeights to use the calculateLineHeight function:
```typescript
lineHeights: {
  xxxl: calculateLineHeight(32),  // ~56px on iOS, ~58px on Android
  xxl: calculateLineHeight(28),   // ~49px on iOS, ~51px on Android
  xl: calculateLineHeight(24),    // ~42px on iOS, ~44px on Android
  lg: calculateLineHeight(18),    // ~32px on iOS, ~34px on Android
  md: calculateLineHeight(16),    // ~28px on iOS, ~30px on Android
  sm: calculateLineHeight(14),    // ~25px on iOS, ~27px on Android
  xs: calculateLineHeight(12),    // ~21px on iOS, ~23px on Android
},
```

4. Add letterSpacing object (if not exists) with Arabic-safe values:
```typescript
letterSpacing: {
  tight: -0.5,    // Only for Latin text
  normal: 0,      // ALWAYS use for Arabic - maintains character connections
  wide: 2,        // Only for Latin uppercase
  extraWide: 6,   // Only for Latin display text
},
```

5. Add exported multipliers for reference:
```typescript
multipliers: {
  arabic: LINE_HEIGHT_MULTIPLIER_ARABIC,
  english: LINE_HEIGHT_MULTIPLIER_ENGLISH,
},
```

6. Update legacy presets (h1, h2, body, caption, small) to use new line heights.

IMPORTANT: Keep all existing colors, spacing, shadows, etc. unchanged. Only modify Typography-related code.
  </action>
  <verify>
Run TypeScript check: `npx tsc --noEmit constants/theme.ts` should pass without errors.
Verify the file contains "Cairo_400Regular" and "LINE_HEIGHT_MULTIPLIER_ARABIC = 1.75".
  </verify>
  <done>
Typography constants updated with:
- Cairo font family names
- 1.75x line height multiplier for Arabic
- Platform-specific Android offset (+2px)
- letterSpacing: 0 for normal (Arabic-safe)
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Cairo Font Loading Hook</name>
  <files>hooks/useCachedFonts.ts</files>
  <action>
Create a new file `hooks/useCachedFonts.ts` with Cairo font loading:

```typescript
/**
 * Font loading hook for Cairo Arabic font
 *
 * Uses Cairo instead of Tajawal due to known iOS clipping issues with Tajawal.
 * Cairo renders correctly across platforms with no diacritic clipping.
 *
 * @see .planning/phases/07.5-arabic-english-typography-spacing/07.5-RESEARCH.md
 */
import { useFonts } from 'expo-font';
import {
  Cairo_400Regular,
  Cairo_500Medium,
  Cairo_600SemiBold,
  Cairo_700Bold,
  Cairo_800ExtraBold,
  Cairo_900Black,
} from '@expo-google-fonts/cairo';

export const useCachedFonts = () => {
  const [fontsLoaded, fontError] = useFonts({
    Cairo_400Regular,
    Cairo_500Medium,
    Cairo_600SemiBold,
    Cairo_700Bold,
    Cairo_800ExtraBold,
    Cairo_900Black,
  });

  return {
    fontsLoaded,
    fontError,
    isReady: fontsLoaded || !!fontError,
  };
};

// Export font names for direct use if needed
export const FontNames = {
  regular: 'Cairo_400Regular',
  medium: 'Cairo_500Medium',
  semibold: 'Cairo_600SemiBold',
  bold: 'Cairo_700Bold',
  extrabold: 'Cairo_800ExtraBold',
  black: 'Cairo_900Black',
} as const;
```

NOTE: This creates the hook. The font package installation and _layout.tsx update will be in Plan 02.
  </action>
  <verify>
File exists at `hooks/useCachedFonts.ts`.
Run TypeScript check (may have import errors until package is installed, which is expected).
  </verify>
  <done>
useCachedFonts hook created with Cairo font loading configuration and FontNames export for reference.
  </done>
</task>

</tasks>

<verification>
1. constants/theme.ts contains Cairo font family names
2. constants/theme.ts has LINE_HEIGHT_MULTIPLIER_ARABIC = 1.75
3. constants/theme.ts has calculateLineHeight function with Platform.OS check
4. hooks/useCachedFonts.ts exists with Cairo font imports
5. TypeScript compilation passes (except expected package import errors)
</verification>

<success_criteria>
- Typography constants use Cairo font family names
- Line heights calculated with 1.75x multiplier
- Android line heights have +2px offset
- letterSpacing.normal is 0 for Arabic safety
- useCachedFonts hook ready for integration
</success_criteria>

<output>
After completion, create `.planning/phases/07.5-arabic-english-typography-spacing/07.5-01-SUMMARY.md`
</output>

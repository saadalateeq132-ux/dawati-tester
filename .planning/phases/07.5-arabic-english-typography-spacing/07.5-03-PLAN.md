---
phase: 07.5-arabic-english-typography-spacing
plan: 03
type: execute
wave: 2
depends_on: ["07.5-01"]
files_modified:
  - components/ui/Text.tsx
  - components/ui/index.ts
autonomous: true

must_haves:
  truths:
    - "Custom Text component applies platform-specific fixes automatically"
    - "Android Text has includeFontPadding: false to prevent extra padding"
    - "Android Text has textAlignVertical: center for proper alignment"
    - "Text component uses Typography constants for font sizing and line height"
    - "letterSpacing is always 0 for Arabic text safety"
  artifacts:
    - path: "components/ui/Text.tsx"
      provides: "Custom Text component with platform fixes"
      contains: "includeFontPadding: false"
    - path: "components/ui/index.ts"
      provides: "UI component exports"
      contains: "export.*Text"
  key_links:
    - from: "components/ui/Text.tsx"
      to: "constants/theme.ts"
      via: "Typography import"
      pattern: "import.*Typography.*from.*theme"
---

<objective>
Create custom Text component with platform-specific typography fixes

Purpose: Centralize platform-specific text rendering fixes (Android includeFontPadding, textAlignVertical) into a reusable component that ensures consistent Arabic text rendering across iOS and Android

Output: Custom Text component that automatically applies correct typography settings
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/07.5-arabic-english-typography-spacing/07.5-RESEARCH.md
@.planning/phases/07.5-arabic-english-typography-spacing/07.5-01-SUMMARY.md
@constants/theme.ts
@components/ui/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Custom Text Component</name>
  <files>components/ui/Text.tsx</files>
  <action>
Create a new file `components/ui/Text.tsx` with the following implementation:

```typescript
/**
 * Custom Text Component with Arabic Typography Fixes
 *
 * This component wraps React Native's Text with:
 * 1. Platform-specific fixes for Android (includeFontPadding, textAlignVertical)
 * 2. Typography system integration (variant-based sizing)
 * 3. Arabic-safe letter spacing (always 0)
 *
 * USAGE:
 * <Text variant="lg" weight="bold">مرحبا</Text>
 * <Text variant="md">Hello World</Text>
 *
 * @see .planning/phases/07.5-arabic-english-typography-spacing/07.5-RESEARCH.md
 */
import React from 'react';
import {
  Text as RNText,
  TextProps as RNTextProps,
  StyleSheet,
  Platform,
  TextStyle,
} from 'react-native';
import { Typography, Colors } from '@/constants/theme';

export type TextVariant = 'xxxl' | 'xxl' | 'xl' | 'lg' | 'md' | 'sm' | 'xs';
export type TextWeight = 'regular' | 'medium' | 'semibold' | 'bold' | 'extrabold' | 'black';

export interface TextProps extends RNTextProps {
  /**
   * Typography size variant
   * @default 'md'
   */
  variant?: TextVariant;

  /**
   * Font weight
   * @default 'regular'
   */
  weight?: TextWeight;

  /**
   * Text color - can be a theme color or custom hex
   * @default Colors.textPrimary
   */
  color?: string;

  /**
   * Whether to center text horizontally
   * @default false
   */
  center?: boolean;
}

export const Text: React.FC<TextProps> = ({
  variant = 'md',
  weight = 'regular',
  color = Colors.textPrimary,
  center = false,
  style,
  children,
  ...props
}) => {
  const fontSize = Typography.sizes[variant];
  const lineHeight = Typography.lineHeights[variant];
  const fontFamily = Typography.fontFamily[weight];

  const textStyle: TextStyle = {
    fontSize,
    lineHeight,
    fontFamily,
    color,
    // CRITICAL: letterSpacing must be 0 for Arabic text
    // Non-zero values break Arabic character connections
    letterSpacing: 0,
    ...(center && { textAlign: 'center' }),
  };

  return (
    <RNText
      style={[styles.base, textStyle, style]}
      {...props}
    >
      {children}
    </RNText>
  );
};

const styles = StyleSheet.create({
  base: {
    // Android-specific fixes for text rendering
    // Source: React Native docs + Arabic typography research
    ...(Platform.OS === 'android' && {
      // Remove extra padding that Android adds for ascenders/descenders
      // This causes misalignment, especially in buttons and centered text
      includeFontPadding: false,
      // Fix vertical alignment on Android
      textAlignVertical: 'center' as const,
    }),
  },
});

// Also export a Heading component for convenience
export const Heading: React.FC<Omit<TextProps, 'variant'> & { level?: 1 | 2 | 3 }> = ({
  level = 1,
  weight = 'bold',
  ...props
}) => {
  const variantMap: Record<1 | 2 | 3, TextVariant> = {
    1: 'xxl',
    2: 'xl',
    3: 'lg',
  };

  return <Text variant={variantMap[level]} weight={weight} {...props} />;
};

// Export type for external use
export type { TextStyle };
```

NOTES:
- Uses @/ path alias which should already be configured in the project
- If path alias not working, use relative import: `import { Typography, Colors } from '../../constants/theme';`
- The includeFontPadding and textAlignVertical are Android-only (Platform.OS check in StyleSheet)
  </action>
  <verify>
1. File exists at `components/ui/Text.tsx`
2. Run TypeScript check: `npx tsc --noEmit components/ui/Text.tsx`
3. Check that file contains `includeFontPadding: false`
4. Check that file contains `letterSpacing: 0`
  </verify>
  <done>
Custom Text component created with:
- TextVariant and TextWeight types for type-safe usage
- Android platform fixes (includeFontPadding: false, textAlignVertical: center)
- Typography system integration (variant-based sizing)
- Arabic-safe letterSpacing: 0
- Bonus Heading component for convenience
  </done>
</task>

<task type="auto">
  <name>Task 2: Export Text Component from UI Index</name>
  <files>components/ui/index.ts</files>
  <action>
Update `components/ui/index.ts` to export the new Text component:

Add the following export to the existing file:

```typescript
// Typography components
export { Text, Heading } from './Text';
export type { TextProps, TextVariant, TextWeight } from './Text';
```

If the file doesn't exist, create it with all existing UI component exports plus the Text export.

Check the existing index.ts content and add the Text export in alphabetical order with other exports.
  </action>
  <verify>
1. `components/ui/index.ts` contains `export { Text, Heading } from './Text'`
2. Run: `npx tsc --noEmit components/ui/index.ts`
  </verify>
  <done>
Text and Heading components exported from UI index, available for import as `import { Text } from '@/components/ui'`
  </done>
</task>

</tasks>

<verification>
1. components/ui/Text.tsx exists with full implementation
2. Text component has includeFontPadding: false for Android
3. Text component has letterSpacing: 0 always
4. components/ui/index.ts exports Text and Heading
5. TypeScript compilation passes
</verification>

<success_criteria>
- Custom Text component available at components/ui/Text.tsx
- Component applies Android fixes automatically
- Component uses Typography system for sizing
- Component exported from components/ui/index.ts
- TypeScript types exported (TextProps, TextVariant, TextWeight)
</success_criteria>

<output>
After completion, create `.planning/phases/07.5-arabic-english-typography-spacing/07.5-03-SUMMARY.md`
</output>

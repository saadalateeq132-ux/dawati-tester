---
phase: 07.5-arabic-english-typography-spacing
plan: 04
type: execute
wave: 3
depends_on: ["07.5-02", "07.5-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Arabic text with diacritics (tashkeel) renders without clipping"
    - "Text is vertically centered in buttons on both iOS and Android"
    - "Arabic character connections are intact (no gaps between letters)"
    - "Line spacing is comfortable for multiline Arabic text"
  artifacts: []
  key_links: []
---

<objective>
Verify Arabic typography rendering on iOS and Android

Purpose: Confirm that the typography changes (Cairo font, 1.75x line height, platform fixes) resolve diacritic clipping and alignment issues on both platforms

Output: Verified working typography, documented test results
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/07.5-arabic-english-typography-spacing/07.5-RESEARCH.md
@.planning/phases/07.5-arabic-english-typography-spacing/07.5-01-SUMMARY.md
@.planning/phases/07.5-arabic-english-typography-spacing/07.5-02-SUMMARY.md
@.planning/phases/07.5-arabic-english-typography-spacing/07.5-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Typography Test Screen</name>
  <files>app/typography-test.tsx</files>
  <action>
Create a temporary test screen to verify typography rendering:

```typescript
/**
 * Typography Test Screen
 *
 * Temporary screen for verifying Arabic typography fixes.
 * Tests line heights, diacritic rendering, and platform-specific fixes.
 *
 * DELETE THIS FILE after verification is complete.
 */
import React from 'react';
import { ScrollView, View, StyleSheet, Platform } from 'react-native';
import { Text, Heading } from '@/components/ui';
import { Colors, Typography, Spacing } from '@/constants/theme';

// Test strings from research document
const TEST_STRINGS = {
  nonVocalized: 'مرحبا بك في التطبيق الخاص بنا',
  vocalized: 'مَرْحَبًا بِكَ فِي التَّطْبِيقِ الخَاصِّ بِنَا',
  mixed: 'مرحبا Welcome إلى to التطبيق the app',
  dotsBelow: 'بِسْمِ اللهِ الرَّحْمٰنِ الرَّحِيمِ',
  english: 'The quick brown fox jumps over the lazy dog',
};

export default function TypographyTestScreen() {
  return (
    <ScrollView style={styles.container} contentContainerStyle={styles.content}>
      <Heading level={1} style={styles.title}>Typography Test</Heading>
      <Text variant="sm" color={Colors.textSecondary} style={styles.subtitle}>
        Platform: {Platform.OS} | Line Height Multiplier: 1.75x
      </Text>

      {/* Section 1: Font Sizes */}
      <View style={styles.section}>
        <Text variant="md" weight="bold" style={styles.sectionTitle}>
          1. Font Sizes (Arabic)
        </Text>
        <Text variant="xxxl">xxxl (32px): {TEST_STRINGS.nonVocalized}</Text>
        <Text variant="xxl">xxl (28px): مرحبا</Text>
        <Text variant="xl">xl (24px): مرحبا</Text>
        <Text variant="lg">lg (18px): مرحبا</Text>
        <Text variant="md">md (16px): مرحبا</Text>
        <Text variant="sm">sm (14px): مرحبا</Text>
        <Text variant="xs">xs (12px): مرحبا</Text>
      </View>

      {/* Section 2: Vocalized Text (CRITICAL) */}
      <View style={styles.section}>
        <Text variant="md" weight="bold" style={styles.sectionTitle}>
          2. Vocalized Text (Diacritics/Tashkeel)
        </Text>
        <Text variant="sm" color={Colors.textSecondary}>
          Check: Fatha (َ), Kasra (ِ), Damma (ُ), Shadda (ّ), Tanwin (ً ٍ ٌ)
        </Text>
        <View style={styles.testBox}>
          <Text variant="xl">{TEST_STRINGS.vocalized}</Text>
        </View>
        <View style={styles.testBox}>
          <Text variant="lg">{TEST_STRINGS.vocalized}</Text>
        </View>
        <View style={styles.testBox}>
          <Text variant="md">{TEST_STRINGS.vocalized}</Text>
        </View>
      </View>

      {/* Section 3: Dots Below Letters */}
      <View style={styles.section}>
        <Text variant="md" weight="bold" style={styles.sectionTitle}>
          3. Letters with Dots Below (ي ب ت)
        </Text>
        <Text variant="sm" color={Colors.textSecondary}>
          Check: Dots should not be clipped
        </Text>
        <View style={styles.testBox}>
          <Text variant="lg">{TEST_STRINGS.dotsBelow}</Text>
        </View>
      </View>

      {/* Section 4: Mixed Arabic/English */}
      <View style={styles.section}>
        <Text variant="md" weight="bold" style={styles.sectionTitle}>
          4. Mixed Arabic/English (BiDi)
        </Text>
        <View style={styles.testBox}>
          <Text variant="md">{TEST_STRINGS.mixed}</Text>
        </View>
      </View>

      {/* Section 5: Button Simulation */}
      <View style={styles.section}>
        <Text variant="md" weight="bold" style={styles.sectionTitle}>
          5. Button Text Alignment
        </Text>
        <Text variant="sm" color={Colors.textSecondary}>
          Check: Text should be vertically centered
        </Text>
        <View style={styles.buttonSimulation}>
          <Text variant="md" weight="semibold" color={Colors.textWhite} center>
            تأكيد
          </Text>
        </View>
        <View style={styles.buttonSimulation}>
          <Text variant="md" weight="semibold" color={Colors.textWhite} center>
            {TEST_STRINGS.vocalized}
          </Text>
        </View>
      </View>

      {/* Section 6: Multiline */}
      <View style={styles.section}>
        <Text variant="md" weight="bold" style={styles.sectionTitle}>
          6. Multiline Text
        </Text>
        <View style={styles.testBox}>
          <Text variant="md">
            {TEST_STRINGS.vocalized}
            {'\n'}
            {TEST_STRINGS.nonVocalized}
            {'\n'}
            {TEST_STRINGS.dotsBelow}
          </Text>
        </View>
      </View>

      {/* Section 7: English Comparison */}
      <View style={styles.section}>
        <Text variant="md" weight="bold" style={styles.sectionTitle}>
          7. English Text (for comparison)
        </Text>
        <Text variant="lg">{TEST_STRINGS.english}</Text>
        <Text variant="md">{TEST_STRINGS.english}</Text>
        <Text variant="sm">{TEST_STRINGS.english}</Text>
      </View>

      {/* Debug Info */}
      <View style={styles.debugSection}>
        <Text variant="sm" weight="bold">Debug Info:</Text>
        <Text variant="xs" color={Colors.textSecondary}>
          Font Family: {Typography.fontFamily.regular}
        </Text>
        <Text variant="xs" color={Colors.textSecondary}>
          Line Heights: xxxl={Typography.lineHeights.xxxl}, lg={Typography.lineHeights.lg}, md={Typography.lineHeights.md}
        </Text>
      </View>
    </ScrollView>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: Colors.background,
  },
  content: {
    padding: Spacing.md,
    paddingTop: Spacing.xl + 44, // Account for status bar
  },
  title: {
    marginBottom: Spacing.xs,
  },
  subtitle: {
    marginBottom: Spacing.lg,
  },
  section: {
    marginBottom: Spacing.xl,
  },
  sectionTitle: {
    marginBottom: Spacing.sm,
    color: Colors.primary,
  },
  testBox: {
    backgroundColor: Colors.backgroundLight,
    padding: Spacing.md,
    borderRadius: 8,
    marginTop: Spacing.xs,
    marginBottom: Spacing.xs,
  },
  buttonSimulation: {
    backgroundColor: Colors.primary,
    paddingVertical: Spacing.md,
    paddingHorizontal: Spacing.lg,
    borderRadius: 8,
    marginTop: Spacing.xs,
    height: 56, // Standard button height
    justifyContent: 'center',
  },
  debugSection: {
    marginTop: Spacing.xl,
    padding: Spacing.md,
    backgroundColor: Colors.backgroundLight,
    borderRadius: 8,
  },
});
```

Run the app and navigate to this screen to test typography.
  </action>
  <verify>
1. File created at app/typography-test.tsx
2. Run `npx expo start` and navigate to typography test screen
3. Visual inspection on simulator/device
  </verify>
  <done>
Typography test screen created for visual verification
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Arabic typography system with:
- Cairo font (replaces Tajawal with iOS clipping issues)
- 1.75x line height multiplier for Arabic diacritics
- Custom Text component with Android fixes (includeFontPadding: false)
- Platform-specific line height adjustments (+2px on Android)
  </what-built>
  <how-to-verify>
1. Start the app: `npx expo start`
2. Navigate to the typography test screen (add temporary route or deep link)
3. Test on BOTH iOS and Android (simulator or device):

**Check each section:**

Section 2 (Vocalized Text) - CRITICAL:
- [ ] All diacritics visible (fatha, kasra, damma above/below letters)
- [ ] Shadda marks (ّ) not clipped
- [ ] Tanwin marks (ً ٍ ٌ) fully visible

Section 3 (Dots Below):
- [ ] Dots under ي ب ت letters fully visible, not cut off

Section 5 (Button Text):
- [ ] Text vertically centered in purple buttons
- [ ] No extra space above/below on Android

Section 6 (Multiline):
- [ ] Comfortable line spacing between lines
- [ ] No overlapping diacritics between lines

**Platform Comparison:**
- [ ] iOS and Android render similarly (minor differences OK)
- [ ] No visible clipping on either platform

If ANY diacritics are clipped or text is misaligned, describe the issue.
  </how-to-verify>
  <resume-signal>
Type "approved" if all checks pass.
Or describe specific issues (e.g., "kasra marks clipped on Android xl size")
  </resume-signal>
</task>

<task type="auto">
  <name>Task 3: Clean Up Test Screen</name>
  <files>app/typography-test.tsx</files>
  <action>
After verification is approved, delete the test screen:

```bash
rm app/typography-test.tsx
```

The test screen was temporary for verification purposes.

NOTE: Only run this task AFTER the checkpoint is approved.
  </action>
  <verify>
File `app/typography-test.tsx` no longer exists.
  </verify>
  <done>
Test screen cleaned up after successful verification.
  </done>
</task>

</tasks>

<verification>
1. Typography test screen created and accessible
2. Human verification of all typography sections
3. No diacritic clipping on iOS or Android
4. Button text properly centered on both platforms
5. Test screen cleaned up after verification
</verification>

<success_criteria>
- TYPO-01: Proper line heights for Arabic text (1.75x multiplier) - VERIFIED
- TYPO-02: Correct letter spacing (0 for Arabic) - VERIFIED
- No diacritic clipping on iOS (Cairo font fix)
- No vertical alignment issues on Android (includeFontPadding fix)
- Human approval of visual verification
</success_criteria>

<output>
After completion, create `.planning/phases/07.5-arabic-english-typography-spacing/07.5-04-SUMMARY.md`
</output>

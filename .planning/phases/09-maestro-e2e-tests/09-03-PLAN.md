---
phase: 09-maestro-e2e-tests
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - maestro/flows/rtl/01-arabic-full-flow.yaml
  - maestro/config.yaml
autonomous: true

must_haves:
  truths:
    - "RTL Arabic flow tests complete user journey in Arabic language"
    - "Flow verifies Arabic text rendering and RTL layout"
    - "Flow captures screenshots showing proper RTL alignment"
  artifacts:
    - path: "maestro/flows/rtl/01-arabic-full-flow.yaml"
      provides: "Full RTL Arabic E2E test"
      contains: "العربية"
    - path: "maestro/config.yaml"
      provides: "RTL flow registration"
      contains: "rtl"
  key_links:
    - from: "maestro/config.yaml"
      to: "maestro/flows/rtl/01-arabic-full-flow.yaml"
      via: "flows.rtl array"
      pattern: "01-arabic-full-flow.yaml"
---

<objective>
Create a comprehensive Maestro E2E test for full RTL Arabic user flow.

Purpose: Ensure the app works correctly in Arabic mode with proper RTL layout, text rendering, and navigation - critical for Saudi Arabian users (primary market).

Output: One comprehensive Maestro flow file that tests the entire app journey in Arabic, capturing RTL visual state at each screen.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@maestro/config.yaml
@maestro/flows/events/02-complete-wizard.yaml
@maestro/flows/marketplace/01-booking-flow.yaml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RTL Arabic Full Flow</name>
  <files>maestro/flows/rtl/01-arabic-full-flow.yaml</files>
  <action>
Create a comprehensive Maestro flow that tests the app entirely in Arabic:

## Setup
```yaml
appId: ${APP_ID}
env:
  TEST_LANG: "ar"
  EVENT_TITLE: "حفل زفاف تجريبي"
```

## Flow Steps:

1. **Launch and Set Arabic**
   - Launch app with clearState: true
   - Navigate to Settings
   - Switch language to Arabic (if not already)
   - Wait for UI to update
   - Screenshot: `screenshots/rtl/01-arabic-settings.png`

2. **Home Screen RTL**
   - Navigate to Home
   - Assert Arabic text visible: "الرئيسية", "إنشاء"
   - Screenshot: `screenshots/rtl/02-home-rtl.png`
   - Verify layout appears RTL (visual check via screenshot)

3. **Create Event in Arabic**
   - Tap "إنشاء حدث" or "إنشاء"
   - Fill event title with Arabic text: ${EVENT_TITLE}
   - Screenshot: `screenshots/rtl/03-create-event-arabic.png`
   - Navigate through wizard steps
   - Assert step labels in Arabic: "الخطوة 1", "التالي"
   - Screenshot at each step

4. **Marketplace in Arabic**
   - Navigate to Marketplace tab: "السوق"
   - Assert Arabic categories visible
   - Screenshot: `screenshots/rtl/04-marketplace-rtl.png`
   - Tap on a vendor
   - Assert Arabic vendor info
   - Screenshot: `screenshots/rtl/05-vendor-profile-rtl.png`

5. **Navigation RTL Test**
   - Use back button
   - Assert proper RTL navigation (back goes right-to-left conceptually)
   - Navigate between tabs
   - Screenshot after each navigation

6. **Form Inputs RTL**
   - Open any form (event creation, guest add)
   - Input Arabic text
   - Verify text alignment (should be right-aligned)
   - Screenshot: `screenshots/rtl/06-form-input-rtl.png`

7. **Final Assertions**
   - Assert no English-only text visible on main screens
   - Assert key Arabic strings present:
     - "الرئيسية" (Home)
     - "الإعدادات" (Settings)
     - "إنشاء" (Create)
     - "السوق" (Marketplace)
   - Screenshot: `screenshots/rtl/07-final-rtl-state.png`

Use heavily:
- `assertVisible` with Arabic text
- `anyOf` for fallback Arabic variations
- Detailed screenshot capture for visual RTL verification
  </action>
  <verify>Run `maestro test maestro/flows/rtl/01-arabic-full-flow.yaml` - flow completes</verify>
  <done>RTL Arabic flow exists with comprehensive Arabic-only journey covering home, events, marketplace, and forms</done>
</task>

<task type="auto">
  <name>Task 2: Update Config for RTL Flows</name>
  <files>maestro/config.yaml</files>
  <action>
Update maestro/config.yaml to register RTL flow:

1. Add to `executionOrder.flowsOrder`:
   - `flows/rtl/*.yaml` (add at the end - RTL tests run after English flows)

2. Add new `rtl` section to `flows`:
   ```yaml
   rtl:
     - maestro/flows/rtl/01-arabic-full-flow.yaml
   ```

3. Add comment explaining RTL flow purpose:
   ```yaml
   # RTL flows - Full Arabic language testing
   rtl:
     - maestro/flows/rtl/01-arabic-full-flow.yaml
   ```
  </action>
  <verify>Validate YAML syntax</verify>
  <done>Config includes rtl section with arabic-full-flow.yaml</done>
</task>

</tasks>

<verification>
- RTL flow file exists in maestro/flows/rtl/
- Flow uses Arabic text throughout (not just bilingual fallbacks)
- Flow captures 7+ screenshots for RTL visual verification
- Config.yaml updated with rtl section
- Flow includes assertions for key Arabic strings
</verification>

<success_criteria>
- `maestro/flows/rtl/01-arabic-full-flow.yaml` exists with 80+ lines
- Flow tests: settings, home, event creation, marketplace in Arabic
- Flow uses Arabic strings as PRIMARY (not fallback)
- Config.yaml includes rtl flow section
- Screenshots directory pattern: screenshots/rtl/
</success_criteria>

<output>
After completion, create `.planning/phases/09-maestro-e2e-tests/09-03-SUMMARY.md`
</output>
